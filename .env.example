# =============================================================================
# Bronn Environment Configuration Template
# =============================================================================
# Copy this file to .env and fill in the values
# NEVER commit .env to version control!

# =============================================================================
# Google Cloud Platform
# =============================================================================
GCP_PROJECT_ID=salesos-473014
GCP_REGION=us-central1

# Firebase Project ID (required for all environments)
# Must match across local, CI, and Cloud Run for environment parity
FIREBASE_PROJECT_ID=salesos-473014

# Cloud SQL (Production - Used in Cloud Run via Unix socket)
CLOUD_SQL_CONNECTION_NAME=salesos-473014:us-central1:bronn-db
DB_USER=bronn
DB_PASS=your-secure-password-here
DB_NAME=bronn

# =============================================================================
# Cloud SQL Auth Proxy (Local Development with Real Cloud SQL)
# =============================================================================
# Run: cloud-sql-proxy salesos-473014:us-central1:bronn-db --port 5432
# Then set these variables to connect to real Cloud SQL locally:
# DB_HOST=127.0.0.1
# DB_PORT=5432

# For local development with local PostgreSQL (alternative to proxy)
DATABASE_URL=postgresql://bronn:password@localhost:5432/bronn

# =============================================================================
# Firebase Configuration (Backend - Service Account)
# =============================================================================
# Path to your Firebase service account JSON file
GOOGLE_APPLICATION_CREDENTIALS=./service-account.json

# =============================================================================
# Firebase Configuration (Frontend - Public Config)
# =============================================================================
# These are safe to expose - they only identify your project
VITE_FIREBASE_API_KEY=your-firebase-api-key
VITE_FIREBASE_AUTH_DOMAIN=salesos-473014.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=salesos-473014

# =============================================================================
# Backend Configuration
# =============================================================================
# Backend URL for frontend API calls
VITE_BACKEND_URL=http://localhost:8000

# JWT secret for internal use (Activepieces integration)
JWT_SECRET_KEY=your-jwt-secret-change-in-production

# =============================================================================
# Activepieces Core Configuration
# =============================================================================
# Edition: ce (Community) - Patched to enable API keys for self-hosted
# Do NOT use 'cloud' or 'ee' unless you have a license
AP_EDITION=ce

# Environment: prod or dev
AP_ENVIRONMENT=prod

# Internal URL for backend â†’ Activepieces communication (uses Docker service name)
# NOTE: Port 8080 is correct - Activepieces nginx listens on 8080, NOT 80
# In Docker: http://activepieces:8080
# In production: Use Cloud Run service URL
ACTIVEPIECES_URL=http://activepieces:8080

# =============================================================================
# Activepieces API Key (Backend-Only)
# =============================================================================
# CRITICAL: This API key is used ONLY by the backend. Users never see or manage it.
# Generate from: Activepieces Admin Console > Settings > API Keys
# Store in:
#   - .env (local development)
#   - GitHub Secrets: ACTIVEPIECES_API_KEY (CI/CD)
#   - GCP Secret Manager: activepieces-api-key (production)
# Without this, /api/flows-proxy/* endpoints will return 503
ACTIVEPIECES_API_KEY=

# =============================================================================
# Activepieces Database
# =============================================================================
AP_POSTGRES_DATABASE=activepieces
# Use 'postgres' for Docker, '/cloudsql/...' for Cloud Run
AP_POSTGRES_HOST=postgres
AP_POSTGRES_PORT=5432
AP_POSTGRES_USERNAME=bronn
AP_POSTGRES_PASSWORD=your-secure-password-here

# =============================================================================
# Activepieces Redis
# =============================================================================
AP_REDIS_HOST=redis
AP_REDIS_PORT=6379

# =============================================================================
# Activepieces Security (Required)
# =============================================================================
# 256-bit encryption key (32 hex characters)
# Generate with: openssl rand -hex 16
AP_ENCRYPTION_KEY=

# JWT secret for session tokens
# Generate with: openssl rand -hex 32
AP_JWT_SECRET=

# =============================================================================
# Activepieces Execution
# =============================================================================
# Execution mode: UNSANDBOXED (single-tenant), SANDBOX_CODE_ONLY (multi-tenant), SANDBOX_PROCESS (high isolation)
AP_EXECUTION_MODE=SANDBOX_CODE_ONLY

# Maximum execution time for workflow steps (seconds)
AP_FLOW_TIMEOUT_SECONDS=600

# Number of concurrent flow workers
AP_FLOW_WORKER_CONCURRENCY=10

# Queue mode: MEMORY for Cloud Run/stateless, REDIS for persistent queues
AP_QUEUE_MODE=MEMORY

# =============================================================================
# Activepieces Branding (Bronn White-Label)
# =============================================================================
# Auth mode: 'managed' disables native Activepieces login (uses Bronn Firebase auth)
# Set to 'managed' for production, leave empty for native auth (development)
AP_BRONN_AUTH_MODE=managed

# Custom app title shown in Activepieces UI
AP_APP_TITLE=Bronn Workflows

# Frontend URL (for redirects and webhooks)
AP_FRONTEND_URL=http://localhost:8080


# =============================================================================
# Docker Compose (Local Development)
# =============================================================================
POSTGRES_DB=bronn
POSTGRES_USER=bronn
POSTGRES_PASSWORD=bronn_dev_password_change_in_prod

# =============================================================================
# CORS Configuration (Production Only)
# =============================================================================
# Comma-separated list of allowed origins
# Leave empty for local development (defaults to localhost:5173, localhost:5000, localhost:8080)
# Example for production:
# CORS_ORIGINS=https://bronn-frontend-XXXXX.us-central1.run.app,https://your-custom-domain.com
CORS_ORIGINS=
